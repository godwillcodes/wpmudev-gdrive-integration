(()=>{var e={20:(e,t,i)=>{"use strict";var s=i(609),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,i){var s,r={},d=null,c=null;for(s in void 0!==i&&(d=""+i),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,s)&&!l.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===r[s]&&(r[s]=t[s]);return{$$typeof:n,type:e,key:d,ref:c,props:r,_owner:a.current}}t.Fragment=r,t.jsx=d,t.jsxs=d},56:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},72:e=>{"use strict";var t=[];function i(e){for(var i=-1,s=0;s<t.length;s++)if(t[s].identifier===e){i=s;break}return i}function s(e,s){for(var r={},o=[],a=0;a<e.length;a++){var l=e[a],d=s.base?l[0]+s.base:l[0],c=r[d]||0,u="".concat(d," ").concat(c);r[d]=c+1;var p=i(u),v={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(v);else{var m=n(v,s);s.byIndex=a,t.splice(a,0,{identifier:u,updater:m,references:1})}o.push(u)}return o}function n(e,t){var i=t.domAPI(t);i.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,n){var r=s(e=e||[],n=n||{});return function(e){e=e||[];for(var o=0;o<r.length;o++){var a=i(r[o]);t[a].references--}for(var l=s(e,n),d=0;d<r.length;d++){var c=i(r[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}r=l}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},609:e=>{"use strict";e.exports=window.React},659:e=>{"use strict";var t={};e.exports=function(e,i){var s=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},673:()=>{},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,n&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var r=i.sourceMap;r&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},848:(e,t,i)=>{"use strict";e.exports=i(20)}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.nc=void 0,(()=>{"use strict";const e=window.wp.element,t=window.wp.i18n,s=window.wp.components;var n=i(72),r=i.n(n),o=i(825),a=i.n(o),l=i(659),d=i.n(l),c=i(56),u=i.n(c),p=i(540),v=i.n(p),m=i(113),w=i.n(m),h=i(673),g=i.n(h),f={};f.styleTagTransform=w(),f.setAttributes=u(),f.insert=d().bind(null,"head"),f.domAPI=a(),f.insertStyleElement=v();r()(g(),f);g()&&g().locals&&g().locals;var _=i(848);function x(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,s)}return i}function j(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?x(Object(i),!0).forEach(function(t){y(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function y(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const b=document.getElementById(window.wpmudevDriveTest.dom_element_id),N=e=>{if(!e||0===e)return"-";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB","TB"][t]},S=()=>{const[i,n]=(0,e.useState)(window.wpmudevDriveTest.authStatus||!1),[r,o]=(0,e.useState)(window.wpmudevDriveTest.hasCredentials||!1),[a,l]=(0,e.useState)(!window.wpmudevDriveTest.hasCredentials),[d,c]=(0,e.useState)(!1),[u,p]=(0,e.useState)(0),[v,m]=(0,e.useState)([]),[w,h]=(0,e.useState)(null),[g,f]=(0,e.useState)(""),[x,y]=(0,e.useState)({message:"",type:""}),[b,S]=(0,e.useState)({clientId:"",clientSecret:""}),C=(0,e.useCallback)(function(e){y({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout(()=>y({message:"",type:""}),5e3)},[]);(0,e.useEffect)(()=>{n(window.wpmudevDriveTest.authStatus||!1),o(window.wpmudevDriveTest.hasCredentials||!1);const e=new URLSearchParams(window.location.search),i=e.get("auth"),s=e.get("error_message");if("success"===i)n(!0),C((0,t.__)("Successfully authenticated with Google Drive!","wpmudev-plugin-test"),"success"),window.history.replaceState({},document.title,window.location.pathname);else if("error"===i){const e=s?decodeURIComponent(s):(0,t.__)("Authentication failed. Please try again.","wpmudev-plugin-test");C(e,"error"),window.history.replaceState({},document.title,window.location.pathname)}},[C]);const T=async()=>{try{c(!0);const e=await fetch("".concat(window.location.origin,"/wp-json/").concat(window.wpmudevDriveTest.restEndpointFiles),{method:"GET",headers:{"X-WP-Nonce":window.wpmudevDriveTest.nonce}}),i=await e.json();if(!e.ok){const e=(null==i?void 0:i.message)||(null==i?void 0:i.code)||(0,t.__)("Failed to load files. Please try again.","wpmudev-plugin-test");return void C(e,"error")}const s=Array.isArray(i)?i:(null==i?void 0:i.data)||[];m(s)}catch(e){C((0,t.__)("An unexpected error occurred while loading files.","wpmudev-plugin-test"),"error")}finally{c(!1)}};return(0,e.useEffect)(()=>{i&&T()},[i]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"sui-header wpmudev-drive-header",children:[(0,_.jsx)("h1",{className:"sui-header-title",children:(0,t.__)("Google Drive Test","wpmudev-plugin-test")}),(0,_.jsx)("p",{className:"sui-description",children:(0,t.__)("Test Google Drive API integration for applicant assessment.","wpmudev-plugin-test")})]}),x.message&&(0,_.jsx)(s.Notice,{status:x.type,isDismissible:!0,onRemove:()=>y({message:"",type:""}),children:x.message}),a?(0,_.jsxs)("div",{className:"sui-box",children:[(0,_.jsx)("div",{className:"sui-box-header",children:(0,_.jsx)("h2",{className:"sui-box-title",children:(0,t.__)("Set Google Drive Credentials","wpmudev-plugin-test")})}),(0,_.jsxs)("div",{className:"sui-box-body",children:[(0,_.jsx)("div",{className:"sui-box-settings-row wpmudev-drive-scopes-row",children:(0,_.jsx)(s.TextControl,{help:(0,e.createInterpolateElement)((0,t.__)("You can get Client ID from <a>Google Cloud Console</a>. Make sure to enable Google Drive API.","wpmudev-plugin-test"),{a:(0,_.jsx)("a",{href:"https://console.cloud.google.com/apis/credentials",target:"_blank",rel:"noopener noreferrer"})}),label:(0,t.__)("Client ID","wpmudev-plugin-test"),value:b.clientId,onChange:e=>S(j(j({},b),{},{clientId:e}))})}),(0,_.jsx)("div",{className:"sui-box-settings-row wpmudev-drive-secret-row",children:(0,_.jsx)(s.TextControl,{help:(0,e.createInterpolateElement)((0,t.__)("You can get Client Secret from <a>Google Cloud Console</a>.","wpmudev-plugin-test"),{a:(0,_.jsx)("a",{href:"https://console.cloud.google.com/apis/credentials",target:"_blank",rel:"noopener noreferrer"})}),label:(0,t.__)("Client Secret","wpmudev-plugin-test"),value:b.clientSecret,onChange:e=>S(j(j({},b),{},{clientSecret:e})),type:"password"})}),(0,_.jsx)("div",{className:"sui-box-settings-row",children:(0,_.jsxs)("span",{children:[(0,t.__)("Please use this URL","wpmudev-plugin-test")," ",(0,_.jsx)("em",{children:window.wpmudevDriveTest.redirectUri})," ",(0,t.__)("in your Google API's Authorized redirect URIs field.","wpmudev-plugin-test")]})}),(0,_.jsxs)("div",{className:"sui-box-settings-row",style:{display:"flex",flexDirection:"column"},children:[(0,_.jsx)("strong",{style:{marginBottom:"6px"},children:(0,t.__)("Required scopes for Google Drive API:","wpmudev-plugin-test")}),(0,_.jsxs)("ul",{style:{margin:0,paddingLeft:"20px"},children:[(0,_.jsx)("li",{children:"https://www.googleapis.com/auth/drive.file"}),(0,_.jsx)("li",{children:"https://www.googleapis.com/auth/drive.readonly"})]})]})]}),(0,_.jsx)("div",{className:"sui-box-footer",children:(0,_.jsx)("div",{className:"sui-actions-right",children:(0,_.jsx)(s.Button,{className:"wpmudev-drive-primary",variant:"primary",onClick:async()=>{if(b.clientId.trim()&&b.clientSecret.trim())try{c(!0);const e=await fetch("".concat(window.location.origin,"/wp-json/").concat(window.wpmudevDriveTest.restEndpointSave),{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.wpmudevDriveTest.nonce},body:JSON.stringify({client_id:b.clientId.trim(),client_secret:b.clientSecret.trim()})}),i=await e.json();if(!e.ok||null==i||!i.success){const e=(null==i?void 0:i.message)||(0,t.__)("Failed to save credentials. Please try again.","wpmudev-plugin-test");return void C(e,"error")}o(!0),l(!1),C((0,t.__)("Credentials saved successfully.","wpmudev-plugin-test"),"success")}catch(e){C((0,t.__)("An unexpected error occurred while saving credentials.","wpmudev-plugin-test"),"error")}finally{c(!1)}else C((0,t.__)("Both Client ID and Client Secret are required.","wpmudev-plugin-test"),"error")},disabled:d,children:d?(0,_.jsx)(s.Spinner,{}):(0,t.__)("Save Credentials","wpmudev-plugin-test")})})})]}):i?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"sui-box",children:[(0,_.jsx)("div",{className:"sui-box-header",children:(0,_.jsx)("h2",{className:"sui-box-title",children:(0,t.__)("Upload File to Drive","wpmudev-plugin-test")})}),(0,_.jsx)("div",{className:"sui-box-body",children:(0,_.jsx)("div",{className:"sui-box-settings-row wpmudev-drive-upload-row",children:(0,_.jsxs)("div",{className:"wpmudev-drive-file-input-wrapper",children:[(0,_.jsxs)("label",{className:"wpmudev-drive-file-label",children:[(0,_.jsx)("input",{type:"file",onChange:e=>{var t;return h((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"drive-file-input",disabled:d}),(0,_.jsx)("span",{className:"wpmudev-drive-file-label-text",children:w?(0,t.__)("Change File","wpmudev-plugin-test"):(0,t.__)("Choose File","wpmudev-plugin-test")})]}),w&&(0,_.jsxs)("div",{className:"wpmudev-drive-file-info",children:[(0,_.jsx)("strong",{children:(0,t.__)("Selected:","wpmudev-plugin-test")})," ",(0,_.jsx)("span",{className:"wpmudev-drive-file-name",children:w.name}),(0,_.jsxs)("span",{className:"wpmudev-drive-file-size",children:["(",N(w.size),")"]})]}),d&&u>0&&(0,_.jsxs)("div",{className:"wpmudev-drive-upload-progress",children:[(0,_.jsx)("div",{className:"wpmudev-drive-progress-bar-wrapper",children:(0,_.jsx)("div",{className:"wpmudev-drive-progress-bar",style:{width:"".concat(u,"%")}})}),(0,_.jsxs)("div",{className:"wpmudev-drive-progress-text",children:[(0,t.__)("Uploading:","wpmudev-plugin-test")," ",u,"%"]})]})]})})}),(0,_.jsx)("div",{className:"sui-box-footer",children:(0,_.jsx)("div",{className:"sui-actions-right",children:(0,_.jsx)(s.Button,{variant:"primary",onClick:async()=>{if(w)return c(!0),p(0),new Promise((e,i)=>{const s=new FormData;s.append("file",w);const n=new XMLHttpRequest;n.upload.addEventListener("progress",e=>{if(e.lengthComputable){const t=Math.round(e.loaded/e.total*100);p(t)}}),n.addEventListener("load",async()=>{if(n.status>=200&&n.status<300)try{const s=JSON.parse(n.responseText);if(null==s||!s.success){const e=(null==s?void 0:s.message)||(null==s?void 0:s.code)||(0,t.__)("Failed to upload file. Please try again.","wpmudev-plugin-test");return C(e,"error"),c(!1),p(0),void i(new Error(e))}h(null);const r=document.querySelector(".drive-file-input");r&&(r.value=""),C((0,t.__)("File uploaded successfully!","wpmudev-plugin-test"),"success"),await T(),c(!1),p(0),e(s)}catch(e){C((0,t.__)("Failed to parse server response.","wpmudev-plugin-test"),"error"),c(!1),p(0),i(e)}else{let e=(0,t.__)("Failed to upload file. Please try again.","wpmudev-plugin-test");try{const t=JSON.parse(n.responseText);e=(null==t?void 0:t.message)||(null==t?void 0:t.code)||e}catch(e){}C(e,"error"),c(!1),p(0),i(new Error(e))}}),n.addEventListener("error",()=>{C((0,t.__)("An unexpected error occurred while uploading the file.","wpmudev-plugin-test"),"error"),c(!1),p(0),i(new Error("Network error"))}),n.addEventListener("abort",()=>{C((0,t.__)("Upload was cancelled.","wpmudev-plugin-test"),"error"),c(!1),p(0),i(new Error("Upload cancelled"))}),n.open("POST","".concat(window.location.origin,"/wp-json/").concat(window.wpmudevDriveTest.restEndpointUpload)),n.setRequestHeader("X-WP-Nonce",window.wpmudevDriveTest.nonce),n.send(s)});C((0,t.__)("Please select a file to upload.","wpmudev-plugin-test"),"error")},disabled:d||!w,children:d?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(s.Spinner,{}),u>0?"".concat(u,"%"):(0,t.__)("Uploading...","wpmudev-plugin-test")]}):(0,t.__)("Upload to Drive","wpmudev-plugin-test")})})})]}),(0,_.jsxs)("div",{className:"sui-box",children:[(0,_.jsx)("div",{className:"sui-box-header",children:(0,_.jsx)("h2",{className:"sui-box-title",children:(0,t.__)("Create New Folder","wpmudev-plugin-test")})}),(0,_.jsx)("div",{className:"sui-box-body",children:(0,_.jsx)("div",{className:"sui-box-settings-row",children:(0,_.jsx)(s.TextControl,{label:(0,t.__)("Folder Name","wpmudev-plugin-test"),value:g,onChange:f,placeholder:(0,t.__)("Enter folder name","wpmudev-plugin-test")})})}),(0,_.jsx)("div",{className:"sui-box-footer",children:(0,_.jsx)("div",{className:"sui-actions-right",children:(0,_.jsx)(s.Button,{variant:"secondary",onClick:async()=>{const e=g.trim();if(e)try{c(!0);const i=await fetch("".concat(window.location.origin,"/wp-json/").concat(window.wpmudevDriveTest.restEndpointCreate),{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.wpmudevDriveTest.nonce},body:JSON.stringify({name:e})}),s=await i.json();if(!i.ok||null==s||!s.success){const e=(null==s?void 0:s.message)||(null==s?void 0:s.code)||(0,t.__)("Failed to create folder. Please try again.","wpmudev-plugin-test");return void C(e,"error")}f(""),C((0,t.__)("Folder created successfully!","wpmudev-plugin-test"),"success"),await T()}catch(e){C((0,t.__)("An unexpected error occurred while creating the folder.","wpmudev-plugin-test"),"error")}finally{c(!1)}else C((0,t.__)("Please enter a folder name.","wpmudev-plugin-test"),"error")},disabled:d||!g.trim(),children:d?(0,_.jsx)(s.Spinner,{}):(0,t.__)("Create Folder","wpmudev-plugin-test")})})})]}),(0,_.jsxs)("div",{className:"sui-box",children:[(0,_.jsxs)("div",{className:"sui-box-header",children:[(0,_.jsx)("h2",{className:"sui-box-title",children:(0,t.__)("Your Drive Files","wpmudev-plugin-test")}),(0,_.jsx)("div",{className:"sui-actions-right",children:(0,_.jsx)(s.Button,{variant:"secondary",onClick:T,disabled:d,children:d?(0,_.jsx)(s.Spinner,{}):(0,t.__)("Refresh Files","wpmudev-plugin-test")})})]}),(0,_.jsx)("div",{className:"sui-box-body",children:d?(0,_.jsxs)("div",{className:"drive-loading",children:[(0,_.jsx)(s.Spinner,{}),(0,_.jsx)("p",{children:(0,t.__)("Loading filesâ€¦","wpmudev-plugin-test")})]}):v.length>0?(0,_.jsx)("div",{className:"wpmudev-drive-files-table",children:(0,_.jsxs)("table",{className:"sui-table",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:(0,t.__)("Name","wpmudev-plugin-test")}),(0,_.jsx)("th",{children:(0,t.__)("Type","wpmudev-plugin-test")}),(0,_.jsx)("th",{children:(0,t.__)("Size","wpmudev-plugin-test")}),(0,_.jsx)("th",{children:(0,t.__)("Modified","wpmudev-plugin-test")}),(0,_.jsx)("th",{children:(0,t.__)("Actions","wpmudev-plugin-test")})]})}),(0,_.jsx)("tbody",{children:v.map(e=>{const i="application/vnd.google-apps.folder"===e.mimeType,n=e.size?N(e.size):"-",r=e.modifiedTime?new Date(e.modifiedTime).toLocaleString():(0,t.__)("Unknown","wpmudev-plugin-test"),o=i?(0,t.__)("Folder","wpmudev-plugin-test"):(e=>{if(!e)return(0,t.__)("File","wpmudev-plugin-test");if("application/vnd.google-apps.folder"===e)return(0,t.__)("Folder","wpmudev-plugin-test");if("application/vnd.google-apps.document"===e)return(0,t.__)("Google Doc","wpmudev-plugin-test");if("application/vnd.google-apps.spreadsheet"===e)return(0,t.__)("Google Sheet","wpmudev-plugin-test");if("application/vnd.google-apps.presentation"===e)return(0,t.__)("Google Slides","wpmudev-plugin-test");const i={"image/jpeg":(0,t.__)("Image","wpmudev-plugin-test"),"image/png":(0,t.__)("Image","wpmudev-plugin-test"),"image/gif":(0,t.__)("Image","wpmudev-plugin-test"),"image/webp":(0,t.__)("Image","wpmudev-plugin-test"),"application/pdf":(0,t.__)("PDF","wpmudev-plugin-test"),"text/plain":(0,t.__)("Text","wpmudev-plugin-test"),"application/zip":(0,t.__)("ZIP","wpmudev-plugin-test"),"application/json":(0,t.__)("JSON","wpmudev-plugin-test")};for(const[t,s]of Object.entries(i))if(e.startsWith(t.split("/")[0]+"/"))return s;const s=e.split("/")[0];return"image"===s?(0,t.__)("Image","wpmudev-plugin-test"):"video"===s?(0,t.__)("Video","wpmudev-plugin-test"):"audio"===s?(0,t.__)("Audio","wpmudev-plugin-test"):(0,t.__)("File","wpmudev-plugin-test")})(e.mimeType);return(0,_.jsxs)("tr",{className:"wpmudev-drive-file-row",children:[(0,_.jsx)("td",{className:"wpmudev-drive-file-name",children:(0,_.jsx)("strong",{children:e.name})}),(0,_.jsx)("td",{className:"wpmudev-drive-file-type",children:(0,_.jsx)("span",{className:"wpmudev-drive-type-badge ".concat(i?"folder":"file"),children:o})}),(0,_.jsx)("td",{className:"wpmudev-drive-file-size",children:n}),(0,_.jsx)("td",{className:"wpmudev-drive-file-date",children:r}),(0,_.jsx)("td",{className:"wpmudev-drive-file-actions",children:(0,_.jsxs)("div",{className:"wpmudev-drive-actions-group",children:[!i&&(0,_.jsx)(s.Button,{variant:"link",size:"small",onClick:()=>(async(e,i)=>{if(e)try{c(!0);const s=await fetch("".concat(window.location.origin,"/wp-json/").concat(window.wpmudevDriveTest.restEndpointDownload,"?file_id=").concat(encodeURIComponent(e)),{method:"GET",headers:{"X-WP-Nonce":window.wpmudevDriveTest.nonce}}),n=await s.json();if(!s.ok||null==n||!n.success){const e=(null==n?void 0:n.message)||(null==n?void 0:n.code)||(0,t.__)("Failed to download file. Please try again.","wpmudev-plugin-test");return void C(e,"error")}const r=atob(n.content),o=new Blob([r],{type:n.mimeType||"application/octet-stream"}),a=window.URL.createObjectURL(o),l=document.createElement("a");l.href=a,l.download=i||n.filename||"download",document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(a),C((0,t.__)("File downloaded successfully!","wpmudev-plugin-test"),"success")}catch(e){C((0,t.__)("An unexpected error occurred while downloading the file.","wpmudev-plugin-test"),"error")}finally{c(!1)}else C((0,t.__)("File ID is missing. Cannot download file.","wpmudev-plugin-test"),"error")})(e.id,e.name),disabled:d,className:"wpmudev-drive-action-btn",children:(0,t.__)("Download","wpmudev-plugin-test")}),e.webViewLink&&(0,_.jsx)(s.Button,{variant:"link",size:"small",href:e.webViewLink,target:"_blank",rel:"noopener noreferrer",className:"wpmudev-drive-action-btn",children:(0,t.__)("View in Drive","wpmudev-plugin-test")})]})})]},e.id)})})]})}):(0,_.jsx)("div",{className:"sui-box-settings-row",children:(0,_.jsx)("p",{children:(0,t.__)("No files found in your Drive. Upload a file or create a folder to get started.","wpmudev-plugin-test")})})})]})]}):(0,_.jsxs)("div",{className:"sui-box wpmudev-drive-auth-box",children:[(0,_.jsx)("div",{className:"sui-box-header",children:(0,_.jsx)("h2",{className:"sui-box-title",children:(0,t.__)("Authenticate with Google Drive","wpmudev-plugin-test")})}),(0,_.jsx)("div",{className:"sui-box-body",children:(0,_.jsxs)("div",{className:"sui-box-settings-row wpmudev-drive-auth-row",children:[(0,_.jsxs)("div",{className:"wpmudev-drive-auth-copy",children:[(0,_.jsx)("p",{className:"wpmudev-drive-auth-intro",children:(0,t.__)("Connect your Google Drive account so we can run the test with real API calls.","wpmudev-plugin-test")}),(0,_.jsx)("p",{className:"wpmudev-drive-auth-note",children:(0,t.__)("We will never store your files. Access is limited to the scopes listed here.","wpmudev-plugin-test")})]}),(0,_.jsxs)("div",{className:"wpmudev-drive-auth-scopes",children:[(0,_.jsx)("p",{className:"wpmudev-drive-auth-scopes-title",children:(0,t.__)("This connection will be able to:","wpmudev-plugin-test")}),(0,_.jsxs)("ul",{children:[(0,_.jsx)("li",{children:(0,t.__)("View and manage Google Drive files","wpmudev-plugin-test")}),(0,_.jsx)("li",{children:(0,t.__)("Upload new files to Drive","wpmudev-plugin-test")}),(0,_.jsx)("li",{children:(0,t.__)("Create folders in Drive","wpmudev-plugin-test")})]})]})]})}),(0,_.jsxs)("div",{className:"sui-box-footer",children:[(0,_.jsx)("div",{className:"sui-actions-left",children:(0,_.jsx)(s.Button,{variant:"secondary",className:"wpmudev-drive-auth-change",onClick:()=>l(!0),children:(0,t.__)("Change Credentials","wpmudev-plugin-test")})}),(0,_.jsx)("div",{className:"sui-actions-right",children:(0,_.jsx)(s.Button,{className:"wpmudev-drive-auth-primary",variant:"primary",onClick:async()=>{if(r)try{c(!0);const e=await fetch("".concat(window.location.origin,"/wp-json/").concat(window.wpmudevDriveTest.restEndpointAuth),{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.wpmudevDriveTest.nonce}}),i=await e.json();if(!e.ok||null==i||!i.success){const e=(null==i?void 0:i.message)||(null==i?void 0:i.code)||(0,t.__)("Failed to start authentication. Please try again.","wpmudev-plugin-test");return C(e,"error"),void c(!1)}i.auth_url?window.location.href=i.auth_url:(C((0,t.__)("Invalid response from server. Please try again.","wpmudev-plugin-test"),"error"),c(!1))}catch(e){C((0,t.__)("An unexpected error occurred while starting authentication.","wpmudev-plugin-test"),"error"),c(!1)}else C((0,t.__)("Please save your Google Drive credentials first.","wpmudev-plugin-test"),"error")},disabled:d,children:d?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(s.Spinner,{}),(0,t.__)("Connecting...","wpmudev-plugin-test")]}):(0,t.__)("Authenticate with Google Drive","wpmudev-plugin-test")})})]})]})]})};e.createRoot?(0,e.createRoot)(b).render((0,_.jsx)(e.StrictMode,{children:(0,_.jsx)(S,{})})):(0,e.render)((0,_.jsx)(e.StrictMode,{children:(0,_.jsx)(S,{})}),b)})()})();